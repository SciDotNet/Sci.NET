<#@ template language="C#" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#
    var testCases = new List<TrigPrimalAndDerivativeState>()
    {
        new(
            "Sin",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-0.909297426825682",
            "-0.841470984807897",
            "0",
            "0.841470984807897",
            "0.909297426825682",
            "-0.416146836547142",
            "0.540302305868140",
            "1.00000000000000",
            "0.540302305868140",
            "-0.416146836547142"),
        new(
            "Cos",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-0.416146836547142",
            "0.540302305868140",
            "1.00000000000000",
            "0.540302305868140",
            "-0.416146836547142",
            "0.909297426825682",
            "0.841470984807897",
            "0",
            "-0.841470984807897",
            "-0.909297426825682"),
        new(
            "Tan",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "2.18503986326152",
            "-1.55740772465490",
            "0",
            "1.55740772465490",
            "-2.18503986326152",
            "5.77439920404192",
            "3.42551882081476",
            "1.00000000000000",
            "3.42551882081476",
            "5.77439920404192"),
        new(
            "Sin2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "0.826821810431806",
            "0.708073418273571",
            "0",
            "0.708073418273571",
            "0.826821810431806",
            "0.756802495307928",
            "-0.909297426825682",
            "0",
            "0.909297426825682",
            "-0.756802495307928"),
        new(
            "Cos2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "0.173178189568194",
            "0.291926581726429",
            "1.00000000000000",
            "0.291926581726429",
            "0.173178189568194",
            "-0.756802495307928",
            "0.909297426825682",
            "0",
            "-0.909297426825682",
            "0.756802495307928"),
        new(
            "Tan2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "4.77439920404192",
            "2.42551882081476",
            "0",
            "2.42551882081476",
            "4.77439920404192",
            "25.2345848944344",
            "-10.6698589449753",
            "0",
            "10.6698589449753",
            "-25.2345848944344"),
        new(
            "Sinh",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-3.62686040784702",
            "-1.17520119364380",
            "0",
            "1.17520119364380",
            "3.62686040784702",
            "3.76219569108363",
            "1.54308063481524",
            "1.00000000000000",
            "1.54308063481524",
            "3.76219569108363"),
        new(
            "Cosh",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "3.76219569108363",
            "1.54308063481524",
            "1.00000000000000",
            "1.54308063481524",
            "3.76219569108363",
            "-3.62686040784702",
            "-1.17520119364380",
            "0",
            "1.17520119364380",
            "3.62686040784702"),
        new(
            "Tanh",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-0.964027580075817",
            "-0.761594155955765",
            "0",
            "0.761594155955765",
            "0.964027580075817",
            "0.0706508248531645",
            "0.419974341614026",
            "1.00000000000000",
            "0.419974341614026",
            "0.0706508248531645"),
        new(
            "Sinh2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "13.1541164180082",
            "1.38109784554182",
            "0",
            "1.38109784554182",
            "13.1541164180082",
            "-27.2899171971278",
            "-3.62686040784702",
            "0",
            "3.62686040784702",
            "27.2899171971278"),
        new(
            "Cosh2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "14.1541164180082",
            "2.38109784554182",
            "1.00000000000000",
            "2.38109784554182",
            "14.1541164180082",
            "-27.2899171971278",
            "-3.62686040784702",
            "0",
            "3.62686040784702",
            "27.2899171971278"),
        new(
            "Tanh2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "0.929349175146836",
            "0.580025658385974",
            "0",
            "0.580025658385974",
            "0.929349175146836",
            "-0.136218687427113",
            "-0.639700008449224",
            "0",
            "0.639700008449224",
            "0.136218687427113"),
        new(
            "ASin",
            "-1.0",
            "-0.5",
            "0.0",
            "0.5",
            "1.0",
            "-1.57079632679490",
            "-0.523598775598299",
            "0",
            "0.523598775598299",
            "1.57079632679490",
            "\u221e",
            "1.15470053837925",
            "1.00000000000000",
            "1.15470053837925",
            "\u221e"),
        new(
            "ACos",
            "-1.0",
            "-0.5",
            "0.0",
            "0.5",
            "1.0",
            "3.14159265358979",
            "2.09439510239319",
            "1.5707963267948966",
            "1.0471975511965979",
            "0",
            "-\u221e",
            "-1.1547005383792517",
            "-1.00000000000000",
            "-1.1547005383792517",
            "-\u221e"),
        new(
            "ATan",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-1.10714871779409",
            "-0.785398163397448",
            "0",
            "0.785398163397448",
            "1.10714871779409",
            "0.200000000000000",
            "0.500000000000000",
            "1.00000000000000",
            "0.500000000000000",
            "0.200000000000000"),
        new(
            "ASin2",
            "-1.0",
            "-0.5",
            "0.0",
            "0.5",
            "1.0",
            "2.46740110027234",
            "0.274155677808038",
            "0",
            "0.274155677808038",
            "2.46740110027234",
            "-\u221e",
            "-1.20919957615615",
            "0",
            "1.20919957615615",
            "\u221e"),
        new(
            "ACos2",
            "-1.0",
            "-0.5",
            "0.0",
            "0.5",
            "1.0",
            "9.86960440108936",
            "4.38649084492860",
            "2.46740110027234",
            "1.09662271123215",
            "0",
            "-\u221e",
            "-4.83679830462458",
            "-3.14159265358979",
            "-2.41839915231229",
            "NaN"),
        new(
            "ATan2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "1.22577828331310",
            "0.616850275068085",
            "0",
            "0.616850275068085",
            "1.22577828331310",
            "-0.442859487117636",
            "-0.785398163397448",
            "0",
            "0.785398163397448",
            "0.442859487117636"),
        new(
            "ASinh",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-1.44363547517881",
            "-0.881373587019543",
            "0",
            "0.881373587019543",
            "1.44363547517881",
            "0.447213595499958",
            "0.707106781186548",
            "1.00000000000000",
            "0.707106781186548",
            "0.447213595499958"),
        new(
            "ACosh",
            "1.0",
            "2.0",
            "3.0",
            "4.0",
            "5.0",
            "0",
            "1.31695789692482",
            "1.76274717403909",
            "2.06343706889556",
            "2.29243166956118",
            "\u221e",
            "0.577350269189626",
            "0.353553390593274",
            "0.258198889747161",
            "0.204124145231932"),
        new(
            "ATanh",
            "-0.9",
            "-0.5",
            "0.0",
            "0.5",
            "0.9",
            "-1.47221948958322",
            "-0.549306144334055",
            "0",
            "0.549306144334055",
            "1.47221948958322",
            "5.26315789473684",
            "1.33333333333333",
            "1.00000000000000",
            "1.33333333333333",
            "5.26315789473684"),
        new(
            "ASinh2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "2.08408338519475",
            "0.776819399895696",
            "0",
            "0.776819399895696",
            "2.08408338519475",
            "-1.29122682289201",
            "-1.24645048028046",
            "0",
            "1.24645048028046",
            "1.29122682289201"),
        new(
            "ACosh2",
            "1.0",
            "2.0",
            "3.0",
            "4.0",
            "5.0",
            "0",
            "1.73437810227264",
            "3.10727759958278",
            "4.25777253729230",
            "5.25524295960705",
            "NaN",
            "1.52069199260189",
            "1.24645048028046",
            "1.06555432050394",
            "0.935881310103570"),
        new(
            "ATanh2",
            "-0.9",
            "-0.5",
            "0.0",
            "0.5",
            "0.9",
            "2.16743022550868",
            "0.301737240203146",
            "0",
            "0.301737240203146",
            "2.16743022550868",
            "-15.4970472587707",
            "-1.46481638489081",
            "0",
            "1.46481638489081",
            "15.4970472587707"),
        new(
            "Csc",
            "0.523598775598299",
            "1.04719755119660",
            "2.09439510239320",
            "2.35619449019234",
            "2.61799387799149",
            "2.00000000000000",
            "1.15470053837925",
            "1.15470053837925",
            "1.41421356237310",
            "2.00000000000000",
            "-3.46410161513775",
            "-0.666666666666667",
            "0.666666666666667",
            "1.41421356237310",
            "3.46410161513775"),
        new(
            "Sec",
            "0.523598775598299",
            "1.04719755119660",
            "2.09439510239320",
            "2.35619449019234",
            "2.61799387799149",
            "1.15470053837925",
            "2.00000000000000",
            "-2.00000000000000",
            "-1.41421356237310",
            "-1.15470053837925",
            "0.666666666666667",
            "3.46410161513775",
            "3.46410161513775",
            "1.41421356237310",
            "0.666666666666667"),
        new(
            "Cot",
            "0.523598775598299",
            "1.04719755119660",
            "2.09439510239320",
            "2.35619449019234",
            "2.61799387799149",
            "1.73205080756888",
            "0.577350269189626",
            "-0.577350269189626",
            "-1.00000000000000",
            "-1.73205080756888",
            "-4.00000000000000",
            "-1.33333333333333",
            "-1.33333333333333",
            "-2.00000000000000",
            "-4.00000000000000"),
        new(
            "Csc2",
            "0.523598775598299",
            "1.04719755119660",
            "2.09439510239320",
            "2.35619449019234",
            "2.61799387799149",
            "4.00000000000000",
            "1.33333333333333",
            "1.33333333333333",
            "2.00000000000000",
            "4.00000000000000",
            "-13.8564064605510",
            "-1.53960071783900",
            "1.53960071783900",
            "4.00000000000000",
            "13.8564064605510"),
        new(
            "Sec2",
            "0.523598775598299",
            "1.04719755119660",
            "2.09439510239320",
            "2.35619449019234",
            "2.61799387799149",
            "1.33333333333333",
            "4.00000000000000",
            "4.00000000000000",
            "2.00000000000000",
            "1.33333333333333",
            "1.53960071783900",
            "13.8564064605510",
            "-13.8564064605510",
            "-4.00000000000000",
            "-1.53960071783900"),
        new(
            "Cot2",
            "0.523598775598299",
            "1.04719755119660",
            "2.09439510239320",
            "2.35619449019234",
            "2.61799387799149",
            "3.00000000000000",
            "0.333333333333333",
            "0.333333333333333",
            "1.00000000000000",
            "3.00000000000000",
            "-13.8564064605510",
            "-1.53960071783900",
            "1.53960071783900",
            "4.00000000000000",
            "13.8564064605510"),
        new(
            "Csch",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-0.275720564771783",
            "-0.850918128239322",
            "\u221e",
            "0.850918128239322",
            "0.275720564771783",
            "-0.286009000645084",
            "-1.11728552744927",
            "-\u221e",
            "-1.11728552744927",
            "-0.286009000645084"),
        new(
            "Sech",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "0.265802228834080",
            "0.648054273663885",
            "1.00000000000000",
            "0.648054273663885",
            "0.265802228834080",
            "0.256240679441676",
            "0.493554347564573",
            "0",
            "-0.493554347564573",
            "-0.256240679441676"),
        new(
            "Coth",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-1.03731472072755",
            "-1.31303528549933",
            "\u221e",
            "1.31303528549933",
            "1.03731472072755",
            "-0.0760218298380711",
            "-0.724061660966310",
            "-\u221e",
            "-0.724061660966310",
            "-0.0760218298380711"),
        new(
            "Csch2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "0.0760218298380711",
            "0.724061660966310",
            "\u221e",
            "0.724061660966310",
            "0.0760218298380711",
            "0.157717126375352",
            "1.90143701945204",
            "-\u221e",
            "-1.90143701945204",
            "-0.157717126375352"),
        new(
            "Sech2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "0.0706508248531645",
            "0.419974341614026",
            "1.00000000000000",
            "0.419974341614026",
            "0.0706508248531645",
            "0.136218687427113",
            "0.639700008449224",
            "0",
            "-0.639700008449224",
            "-0.136218687427113"),
        new(
            "Coth2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "1.07602182983807",
            "1.72406166096631",
            "\u221e",
            "1.72406166096631",
            "1.07602182983807",
            "0.157717126375352",
            "1.90143701945204",
            "-\u221e",
            "-1.90143701945204",
            "-0.157717126375352"),
        new(
            "ACsc",
            "-2.0",
            "-1.0",
            "1.0",
            "2.0",
            "3.0",
            "-0.523598775598299",
            "-1.57079632679490",
            "1.57079632679490",
            "0.523598775598299",
            "0.339836909454122",
            "-0.288675134594813",
            "-\u221e",
            "-\u221e",
            "-0.288675134594813",
            "-0.117851130197758"),
        new(
            "ASec",
            "-2.0",
            "-1.0",
            "1.0",
            "2.0",
            "3.0",
            "2.09439510239320",
            "3.14159265358979",
            "0",
            "1.04719755119660",
            "1.23095941734077",
            "0.288675134594813",
            "\u221e",
            "\u221e",
            "0.288675134594813",
            "0.117851130197758"),
        new(
            "ACot",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "-0.463647609000806",
            "-0.785398163397448",
            "1.57079632679490",
            "0.785398163397448",
            "0.463647609000806",
            "-0.200000000000000",
            "-0.500000000000000",
            "-1.00000000000000",
            "-0.500000000000000",
            "-0.200000000000000"),
        new(
            "ACsc2",
            "-2.0",
            "-1.0",
            "1.0",
            "2.0",
            "3.0",
            "0.274155677808038",
            "2.46740110027234",
            "2.46740110027234",
            "0.274155677808038",
            "0.115489125027329",
            "0.302299894039036",
            "\u221e",
            "-\u221e",
            "-0.302299894039036",
            "-0.0801003277241628"),
        new(
            "ASec2",
            "-2.0",
            "-1.0",
            "1.0",
            "2.0",
            "3.0",
            "4.38649084492860",
            "9.86960440108936",
            "0",
            "1.09662271123215",
            "1.51526108713994",
            "1.20919957615615",
            "\u221e",
            "NaN",
            "0.604599788078073",
            "0.290139917122368"),
        new(
            "ACot2",
            "-2.0",
            "-1.0",
            "0.0",
            "1.0",
            "2.0",
            "0.214969105332164",
            "0.616850275068085",
            "2.46740110027234",
            "0.616850275068085",
            "0.214969105332164",
            "0.185459043600322",
            "0.785398163397448",
            "-3.14159265358979",
            "-0.785398163397448",
            "-0.185459043600322"),
        new(
            "ACsch",
            "-2.0",
            "-1.0",
            "1.0",
            "2.0",
            "3.0",
            "-0.481211825059603",
            "-0.881373587019543",
            "0.881373587019543",
            "0.481211825059603",
            "0.327450150237258",
            "-0.223606797749979",
            "-0.707106781186548",
            "-0.707106781186548",
            "-0.223606797749979",
            "-0.105409255338946"),
        new(
            "ASech",
            "0.2",
            "0.3",
            "0.5",
            "0.8",
            "1.0",
            "2.29243166956118",
            "1.87382024252741",
            "1.31695789692482",
            "0.693147180559945",
            "0",
            "-5.10310363079829",
            "-3.49428278907306",
            "-2.30940107675850",
            "-2.08333333333333",
            "-\u221e"),
        new(
            "ACoth",
            "-2.0",
            "-1.0",
            "1.0",
            "2.0",
            "3.0",
            "-0.549306144334055",
            "-\u221e",
            "\u221e",
            "0.549306144334055",
            "0.346573590279973",
            "-0.333333333333333",
            "-\u221e",
            "-\u221e",
            "-0.333333333333333",
            "-0.125000000000000"),
        new(
            "ACsch2",
            "-2.0",
            "-1.0",
            "1.0",
            "2.0",
            "3.0",
            "0.231564820577194",
            "0.776819399895696",
            "0.776819399895696",
            "0.231564820577194",
            "0.107223600890403",
            "0.215204470482002",
            "1.24645048028046",
            "-1.24645048028046",
            "-0.215204470482002",
            "-0.0690325529942708"),
        new(
            "ASech2",
            "0.2",
            "0.3",
            "0.5",
            "0.8",
            "1.0",
            "5.25524295960705",
            "3.51120230130550",
            "1.73437810227264",
            "0.480453013918201",
            "0",
            "-23.3970327525893",
            "-13.0953156465605",
            "-6.08276797040757",
            "-2.88811325233311",
            "NaN"),
        new(
            "ACoth2",
            "-2.0",
            "-1.0",
            "1.0",
            "2.0",
            "3.0",
            "0.301737240203146",
            "\u221e",
            "\u221e",
            "0.301737240203146",
            "0.120113253479550",
            "0.366204096222703",
            "\u221e",
            "-\u221e",
            "-0.366204096222703",
            "-0.0866433975699932")
    };
#>// Copyright (c) Sci.NET Foundation. All rights reserved.
// Licensed under the Apache 2.0 license. See LICENSE file in the project root for full license information.
// <auto-generated />

using System.Numerics;
using Sci.NET.Common.Numerics;
using Sci.NET.Mathematics.Backends.Devices;
using Sci.NET.Mathematics.Tensors;
using Sci.NET.Tests.Framework.Assertions;
using Sci.NET.Tests.Framework.Integration;

namespace Sci.NET.Mathematics.IntegrationTests.Tensors.Trigonometry;

public class TrigWithBackwardsShould : IntegrationTestBase
{
<#
    foreach (var function in testCases)
    {
#>
    [Theory]
    [MemberData(nameof(ComputeDevices))]
    public void ReturnCorrectResult_For<#= function.FunctionName #>(IDevice device)
    {
        // Arrange
        using var input = Tensor.FromArray<double>(new[] { <#= function.Input1 #>, <#= function.Input2 #>, <#= function.Input3 #>, <#= function.Input4 #>, <#= function.Input5 #> }, requiresGradient: true);
        var expectedOutput = new[] { <#= TrigPrimalAndDerivativeState.Parse(function.Primal1) #>, <#= TrigPrimalAndDerivativeState.Parse(function.Primal2) #>, <#= TrigPrimalAndDerivativeState.Parse(function.Primal3) #>, <#= TrigPrimalAndDerivativeState.Parse(function.Primal4) #>, <#= TrigPrimalAndDerivativeState.Parse(function.Primal5) #> };
        var expectedGradient = new[] { <#= TrigPrimalAndDerivativeState.Parse(function.Derivative1) #>, <#= TrigPrimalAndDerivativeState.Parse(function.Derivative2) #>, <#= TrigPrimalAndDerivativeState.Parse(function.Derivative3) #>, <#= TrigPrimalAndDerivativeState.Parse(function.Derivative4) #>, <#= TrigPrimalAndDerivativeState.Parse(function.Derivative5) #> };
        input.To(device);

        // Act
        var result = input.<#= function.FunctionName #>();
        
        result.Backward();

        // Assert
        result.Should().HaveApproximatelyEquivalentElements(expectedOutput, 1e-5);
        input.Gradient!.Should().HaveApproximatelyEquivalentElements(expectedGradient, 1e-5);
    }

<#
    }
#>}
<#+
    public class TrigPrimalAndDerivativeState
    {
        public string FunctionName { get; set; }

        public string Input1 { get; set; }

        public string Input2 { get; set; }

        public string Input3 { get; set; }

        public string Input4 { get; set; }

        public string Input5 { get; set; }

        public string Primal1 { get; set; }

        public string Primal2 { get; set; }

        public string Primal3 { get; set; }

        public string Primal4 { get; set; }

        public string Primal5 { get; set; }

        public string Derivative1 { get; set; }

        public string Derivative2 { get; set; }

        public string Derivative3 { get; set; }

        public string Derivative4 { get; set; }

        public string Derivative5 { get; set; }

        public TrigPrimalAndDerivativeState(
            string functionName,
            string input1,
            string input2,
            string input3,
            string input4,
            string input5,
            string primal1,
            string primal2,
            string primal3,
            string primal4,
            string primal5,
            string derivative1,
            string derivative2,
            string derivative3,
            string derivative4,
            string derivative5)
        {
            FunctionName = functionName;
            Input1 = input1;
            Input2 = input2;
            Input3 = input3;
            Input4 = input4;
            Input5 = input5;
            Primal1 = primal1;
            Primal2 = primal2;
            Primal3 = primal3;
            Primal4 = primal4;
            Primal5 = primal5;
            Derivative1 = derivative1;
            Derivative2 = derivative2;
            Derivative3 = derivative3;
            Derivative4 = derivative4;
            Derivative5 = derivative5;
        }

        public static string Parse(string value)
        {
            var result = double.Parse(value);

            if (double.IsPositiveInfinity(result))
            {
                return "double.PositiveInfinity";
            }
            if (double.IsNegativeInfinity(result))
            {
                return "double.NegativeInfinity";
            }
            if (double.IsNaN(result))
            {
                return "double.NaN";
            }
            return result.ToString("R");
        }
    }
#>